def _disable_linux_iproute():
    """
    Disable IP route ( IP Forward ) in linux-based distro
    """
    filePath = "/proc/sys/net/ipv4/ip_forward"
    with open(filePath) as f:
        if f.read() == 0:
            # already disabled
            return
    
    with open(filePath, "w") as f:
        print(0, file=f)


def _disable_window_iproute():
    """
    Disables IP route (IP Forwarding) in Windows
    """
    from IPForwarding.services import WService
    # enable Remote Access service
    service = WService("RemoteAccess")
    service.stop()


def disable_ip_route(verbose=True):
    """
    Disable IP Forwarding
    """
    import os
    if verbose:
        print("[!] disabling IP Routing ...")
    
    try:
        _disable_window_iproute() if "nt" in os.name else _disable_linux_iproute()

        if verbose:
            print("[!] IP Routing disabled")
    except Exception as e:
        if verbose:
            print(f"[-] Unable to stop service : {e}")
        exit(1)
