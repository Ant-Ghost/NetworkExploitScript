import sys

def _enable_linux_iproute():
    """
    Enable IP route ( IP Forward ) in linux-based distro
    """
    filePath = "/proc/sys/net/ipv4/ip_forward"
    with open(filePath) as f:
        if f.read() == 1:
            # already enabled
            return
    
    with open(filePath, "w") as f:
        print(1, file=f)


def _enable_window_iproute():
    """
    Enables IP route (IP Forwarding) in Windows
    """
    from IPForwarding.services import WService
    # enable Remote Access service
    service = WService("RemoteAccess")
    service.start()


def enable_ip_route(verbose=True):
    """
    Enable IP Forwarding
    """
    import os
    if verbose:
        print("[!] Enbling IP Routing ...")
    
    try:
        _enable_window_iproute() if "nt" in os.name else _enable_linux_iproute()

        if verbose:
            print("[!] IP Routing enabled")
    except Exception as e:
        if verbose:
            print(f"[-] Unable to start service : {e}")
        exit(1)
